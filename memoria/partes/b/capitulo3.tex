\chapter{Manual de uso de la librería}
Una vez especificados los requisitos de nuestra pizarra, además de los UML necesarios que describen su funcionamiento, incorporamos un breve manual de usuario con el que un programador ajeno podría construir fácilmente un agente o grupo de agentes que utilicen la pizarra para comunicarse.
\section{Consideraciones previas}
Se considerará que nuestro PC cumple con todos los requisitos necesarios para que tanto nuestra librería como nuestra aplicación puedan funcionar sin problemas. Ello conlleva que nuestro PC disponga de conexión a Internet y tenga instalado algún compilador de C++. En definitiva, que se pueda instalar y usar nuestra aplicación sin problemas añadidos.

\section{Puesta a punto de la aplicación} \label{sec:puesta}
En primer lugar se detallarán los primeros pasos típicos que realizará nuestra aplicación. Primeramente será necesario conectarnos (se considerará que el registro, donde se especifican tanto el nombre de usuario como la contraseña se han realizado anterior y correctamente, por ejemplo, en nuestra aplicación).\\

Existen dos tipos de usuarios: administradores y normales. Los primeros cuentan con más opciones, y se explicarán más adelante. Lo primero de todo será Iniciar sesión, que se realizará de la siguiente manera:
\begin{verbatim}


#include <pizarra.h>
#include <iostream.h>

using namespace std;

Agente app = new Agente(loginuser, passuser, new Pizarra(IP, puerto, nombre)); 
//Creamos un agente con los parámetros que hemos introducido por teclado

Usuario user = app.iniciarSesion(app.getUser(), pass); 
//Llama al método que nos permitirá iniciar sesión

if(user != null){ 
// Si el usuario ha introducido sus datos correctamente 
y éstos se encuentran en la base de datos

}else{            
// No ha encontrado el usuario o la contraseña incorrecta, y 
se mostrará el pertinente mensaje 

    Pizarra.existe(user) ? cout << "Contraseña incorrecta":
    cout << "Nombre de usuario incorrecto";
}
\end{verbatim}

A continuación se hará una breve descripción de las funcionalidades de las que dispone un agente:
\section{Funcionalidades y ejemplos}
\subsection{Iniciar sesión}
Como ya se ha explicado en el apartado de primeros pasos (Véase apartado \ref{sec:puesta}) , este método será invocado constantemente por parte de los usuarios de nuestra aplicación, y su funcionamiento es el siguiente:\\
En primer lugar el usuario deberá introducir su nombre de usuario y contraseña formados por sendos string que se parametrizarán en iniciarSesión(string userid, string pass). A continuación la clase Pizarra recibe dicho parámetros en pizarra.buscar(string userid , string pass), que consultará en la base de datos si los parámetros introducidos son correctos. Si lo han sido, devolverá el usuario con sus correspondientes permisos, lo que permitirá al agente comprobar que puede y que no puede hacer.

\subsection{Mostrar estadísticas}\label{sec:est}
Esta funcionalidad permite saber las estadísticas a nivel de usuario, es decir, el número de archivos editados, permisos cambiados, datos borrados etc. Para ello será necesario que el agente introduzca su nombre de usuario, que mediante mostrarEstadísticas(string userid) se comunicará con la pizarra, y finalmente con la clase Estadísticas, mediante la cual se podrán consultar los cambios realizados por cada usuario, además de la opción de refrescar las estadísticas (por si durante la consulta de dichas estadísticas otro usuario realiza alguna opción que modifique las ahora obsoletas).
\subsection{Mostrar estadísticas generales}
Funciona de un modo muy parecido a mostrar estadísticas (Véase apartado \ref{sec:est}), con la diferencia de que ahora podremos consultar las estadísticas a nivel global, de todos los usuarios como un solo grupo de trabajo. Esto permitirá consultar el número de archivos subidos al repositorio, archivos borrados,... pero todo desde un punto de vista grupal.
\subsection{Escribir}
Es una operación básica de la pizarra, junto a leer y lectura/escritura. Esta operación permite tanto añadir como modificar archivos de la pizarra. Esta operación está limitada por los permisos del usuario que quiera escribir (salvo el Admin).\\
Para poder escribir será necesario que el agente especifique el archivo que se quiere editar, así como su dirección. A continuación, la pizarra comprobará mediante Pizarra.getPermiso() si el usuario dispone de los permisos necesarios. En caso afirmativo, se procede a subir y modificar la pizarra con los nuevos archivos. Finalmente, se hace una llamada a la base de datos para actualizar los nuevos archivos. Por el contrario si el usuario no contaba con los permisos pertinentes, se le notificará y no se producirá ningún cambio.\\
Debido a la importancia de esta funcionalidad se adjunta un pequeño código de ejemplo (consideramos que ya ha iniciado sesión) :
\begin{verbatim}


#include <pizarra.h>
#include <iostream.h>

using namespace std;

Agente app = new Agente(loginuser, passuser, new Pizarra(IP, puerto, nombre)); 
//Creamos un agente con los parámetros que hemos introducido por teclado

Usuario user = app.escribir("C:\Program files", Archivo ejemplo); 
//Llama al método que nos permitirá iniciar sesión

if(user.getPermiso() ==1){ 
// El usuario dispone de los permisos necesarios

}else{            
// No tiene los permisos y salta un mensaje de advertencia

    Pizarra.existe(user) ? cout << "No dispone de los permisos necesarios":
}
\end{verbatim}
\subsection{Lectura/Escritura}
Lectura/Escritura funciona de manera análoga a escribir, salvo que en esta operación se permite también leer.
\subsection{Leer}
Esta operación es análoga a escribir, salvo que en lugar de escribir se leen archivos.

\subsection{Mostrar estado}
Permite mostrar el estado actual de la pizarra, es decir, el número de usuarios totales, el número de archivos en la pizarra, el historial de todas las modificaciones, etc.

\subsection{Buscar}
Permite buscar archivos en la pizarra. Se podrán especificar varios parámetros de búsqueda, como podrían ser el nombre, tamaño, extensión, modificación, etc. El agente debe introducir un String con el nombre del archivo deseado y se facilitará una lista con los archivos encontrados, en caso de que los hubiera.
\subsection{Comparar}
Permite comparar dos archivos, pudiendo por tanto apreciar las diferencias existentes en aspectos como tamaño, formato o líneas modificadas. Para ello será necesario que el agente introduzca el archivo en comparar(Archivo archivo), y al igual que en otras funcionalidades se guardará el usuario que ha realizado dicha comparación. Finalmente se devuelve un archivo donde se indican las diferencias.

\subsection{Crear Carpeta}
Permite crear una carpeta dentro de la pizarra.Para ello será necesario introducir la ruta y nombre de la carpeta que deseamos crear (debe tener un nombre único), que en crearCarpeta(string direccion, string nombre), que se comunica con pizarra.crearCarpeta(), que además de precisar los dos anteriores datos guardará el usuario que ha creado la carpeta y los permisos que tiene.

\subsection{Crear Usuario}
Permite crear nuevos agentes en la pizarra. Esta función solo puede ser usada por el Administrador. Para ello se deberán introducir como viene siendo habitual el nombre de usuario y la contraseña. La pizarra comprobará que el efectivamente se trata del administrador consultando en la base de datos el nivel asociado al nombre de usuario. Si el resultado es satisfactorio, se invocará el método crearUsuario(), donde se deberán especificar el nuevo nombre de usuario, contraseña, y nivel que dispondrá el nuevo usuario. Finalmente se comprobará que el nombre de usuario deseado no esté ya en uso, en cuyo caso se deberá cambiar.
\subsection{Gestionar permisos}
Una explicación más detallada precisan los permisos, que pueden tener los distintos usuarios. En nuestra aplicación los usuarios podrán tener los 3 permisos básicos típicos, tal y como se explica en la siguiente tabla: \\

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
Número & Permiso  & Descripción \\
\hline
0& Leer & El usuario puede obtener información de la pizarra\\
1& Escribir & El usuario puede añadir datos a la pizarra\\
2& Buscar & El usuario puede buscar archivos en la pizarra\\
\hline
\end{tabular}
\end{center}

Dichos permisos sólo pueden ser modificados por el usuario Administrador mediante agente.gestionarPermisos() que invocará a pizarra.gestionarPermisos() y  finalmente a \\ Nivel.cambiarPermiso() donde se podrán especificar los nuevos permisos del usuario. El administrador dispondrá de todos los permisos.

\subsection{Configurar pizarra}
Mediante esta función podemos configurar algunos aspectos de nuestra pizarra, como podrían ser asuntos de conexión, máximo de conexiones simultáneas, número máximo de usuarios permitidos y algunas opciones de depuración. Para ello será necesario que el agente acceda a configurarPizarra(Configuración config), para que a continuación la pizarra reciba la configuración nueva, además del usuario que la ha definido.

